## Towards Continuous Access Control Validation and Forensics

实现连续访问控制验证和取证



**摘要：**

​		在现实世界的实践中，由于系统管理员（sysadmins）引入的普遍的策略错误配置，访问控制经常被报告为“严重破坏”。鉴于资源和数据共享的动态性，访问控制策略需要不断更新。不幸的是，人类系统管理员经常犯错误，例如在更改访问控制策略时过度授予特权。由于目前对持续验证的工具支持有限，此类错误可能会在很长一段时间内被忽略，直到最终被攻击者利用，从而导致灾难性的安全事件。

​		我们介绍了**P-DIFF，这是一种用于监控访问控制行为的实用工具，可帮助系统管理员及早发现意外的访问控制策略更改，并对安全攻击进行事后取证分析**。P-DIFF持续监视访问日志并从中推断访问控制策略。为了应对策略演化的挑战，我们设计了一种新的时变决策树来有效地表示访问控制策略的变化，并结合一种新的学习算法从访问日志中推断出树。P-DIFF向系统管理员提供推断的策略和检测到的更改，以帮助完成以下两项任务：（1）验证访问控制更改是否是有意的；（2） 查明导致特定安全攻击的历史变化。

​		我们使用从五个真实系统收集的各种数据集评估P-DIFF，其中两个来自工业公司。PDIFF可以检测86%–100%的访问控制策略更改，平均精度为89%。对于forensic分析，P-DIFF可以精确定位85%–98%评估案例中允许目标访问的根本原因变化。



#### Mitivation

近年来访问控制配置错误已成为安全事件（如数据盗窃和系统泄漏）的一个重要原因：

当今访问控制管理中缺少的一个关键部分是连续行为验证，它允许系统管理员验证系统在配置更改后是否按照预期运行。访问控制配置需要经常更改，下面列出了系统管理员需要修改访问控制策略：

**用户更改**：用户可以加入、离开或更改组织或项目中的角色

**数据更改**：某些数据可能变得敏感或可能开始包含敏感信息

**功能更改**：添加新功能、访问或服务，供公众或特定的用户组访问

**域更改**：数据需要重新组织为不同的域或子域

为了适应上面的更改，系统管理员可能会引入配置错误，适应这些更改不容易，可能会涉及到多个组件。管理员在被请求更改时，可能会有时间压力而导致配置错误。在解决拒绝访问问题时，38.1%的更改引入了配置错误，过度授予权限并造成漏洞。



目前最先进的访问控制错误配置检测工具主要检测配置的不一致性。访问控制配置错误通常难以发现，直到被恶意攻击，原因和其他类型的配置错误不同，访问控制配置错误不能通过可观察到的症状（如崩溃、功能失调，性能下降）表现出来。



访问控制通常在大规模复杂系统中跨多个不同组件的配置和代码中实现。通过静态检查配置和代码来推断端到端的访问控制行为是非常重要的。本文建议从记录端到端访问结果（通常是顶层组件的输出）的访问日志来推断访问控制行为和行为更改。一旦检测到行为更改，将通知系统管理员进行验证是否改变是有意的。一旦检测到意外更改，系统管理员可以及时修复访问控制，并避免将来发生潜在的安全事件（如数据泄漏）

#### Contribution

本文介绍了P-DIFF，一种从访问日志推断访问控制行为和行为变化的实用工具。大多数软件系统生成的现有访问日志包含足够的信息来推断更改，因此，P-DIFF不需要对现有系统进行任何修改，只需要启用访问日志。此外，P-DIFF还不要求系统管理员记录访问控制配置更改。

通过检测访问控制行为的变化，P-DIFF有效地帮助系统管理员完成以下两项重要任务：

•**变化验证**。当P-DIFF观察到访问控制行为的变化时，它会将观察到的变化通知系统管理员。
这使系统管理员能够检查更改，以识别和修复打开安全漏洞的访问控制错误配置。
•**forensic分析**。对于安全事件的事后分析，P-DIFF可以回溯与恶意访问相关的所有行为更改。这为系统管理员提供了一些线索，以了解什么时候以及什么样的更改打开了访问。这些线索可以帮助系统管理员缩小他们需要在日志或版本控制系统中调查的更改记录范围。



#### 设计实现P-DIFF的两个挑战

一：如何表示访问控制行为

二：如何在推断决策树的同时处理行为变化

从五个真实系统手机的数据集评估P-DIFF，对于更改验证，PDIFF可以检测86%-100%的规则更改，对于forensic分析，可以查明导致85%到98%评估案例中目标访问的根本原因变化。



2.观察

访问控制配置的异构性给构建通用的自动化工具带来了重大的挑战。



































































